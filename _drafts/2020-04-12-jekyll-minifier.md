---
layout: post
title: "Разработал минификаторы html и JavaScript для Jekyll"
date: 2020-12-04
modified: 2020-12-04
categories: Jekyll Liquid web
tags: [Jekyll, Liquid, html, JavaScript, GitHub Pages, web]
excerpt_separator: <a name="cut"></a>
links_in_new_tab: true
disqus_page_id: ts5C3tLEk52N029aeVmh5b3hjBjE8N0X4zI722925539AOx7kD4D2C8T92T542Ec
---
Мой сайт, который вы сейчас читаете, построен при помощи генератора статических сайтов [Jekyll](https://jekyllrb.com/). Очень много о статических сайтах и Jekyll в частности можно прочитать в Интернете. Пользуясь этой технологией, я пришёл к тому, что Jekyll не умеет из коробки минифицировать html страницы и javascript код. В разметке или коде, который пишет человек много лишних символов: отступы, ненужные пробелы, комментарии. Всё это не влияет на отображение страниц, однако занимает место и всегда передаётся клиентскому браузеру, растрачивая трафик пользователя и его время для загрузки страницы. Сегодня редко встретишь сайты, где не используется минификация кода. Под катом вы найдёте как я для себя, пусть не окончательно, но решил эту проблему при использовании Jekyll при этом сохраняя поддержку с GitHub Pages.
<a name="cut"></a>
Статический сайт является таковым в том плане, что задача web сервера, который его обслуживает сводится к простой отдачи заранее созданных файлов. То есть не подразумевается использования какой-нибудь базы данных, или генерации html на лету. Все html страницы, стили и скриптовые файлы уже заранее сгенерированны Jekyll'ом (статические) и web-сервер их просто отдаёт по запросу клиента. Такой способ создания сайтов имеет свои преимущества и недостатки. Основной недостаток очевиден: нет возможности подключить базу данных. Но достоинства тоже большие - прежде всего малые требования к web-серверу, безопасность (здесь нечего взламывать). Ещё одним неоспоримым достоинством, является то, что для статических сайтов существуют бесплатные хостинги. В итоге, для того, чтобы создать свой сайт, вам не нужно иметь собственный или арендованный сервер, не нужно настраивать его и платить за него.  
Одним из таких хостингов является [GitHub Pages](https://pages.github.com/). GitHub Pages поддерживает Jekyll, поэтому публикация сайта сводится к обыденной пушу git репозитория с вашим Jekyll проектом на GitHub. GitHub сам запустит Jekyll на своих мощностях, сгенерирует файлы для статического сайта и опубликует его.  
Я познакомился с Jekyll, когда искал платформу для своего блога и нактнулся на GitHub Pages. И Jekyll мне понравился.  
Зачем вообще генерировать файлы сайта, нельзя ли их просто создать руками? Ну конечно можно, и даже можно опубликовать их при помощи GitHub Pages без всякого Jekyll. Просто это неудобно. Первое, что приходит в голову о назначении генератора сайта - это повторное использование уже написанных кусков разметки и кода. Например, разные страницы могут содержать много общих элементов, каких-то заголовков, скриптов и прочее. Это всё можно написать один раз и Jekyll подставит эти данные в нужные места автоматически. Вся магия Jekyll - это возможности делать автоматизацию при помощи специальной разметки [Liquid](https://shopify.github.io/liquid/). По сути - это программирование того, как будет устроен итоговый файл, который web-сервер должен отдать клиенту. Эта разметка поддерживает циклы, условия, работу со строками, датами и т.д. Здесь я не буду подробно описывать работу с Jekyll и Liquid. На [официальном сайте](https://jekyllrb.com/) есть отличная документация. Скажу только, что структура сайта строится при помощи специального языка разметки [Liquid](https://shopify.github.io/liquid/).  
Кроме того, Jekyll позволяет подключать дополнительные плагины, написанные на Ruby. И среди этих плагинов есть и такие, которые минифицируют html и javascript. Проблема в том, что GitHub Pages поддерживает только ограниченное число плагинов. Это, вероятно, сделано по соображениям безопасности. Поэтому штатных нет способов минифицировать сгенерированные Jelyll файлы.  
Но GitHub Pages естественным образом работает с Liquid, а это хоть и не очень удобный для наших целей, но всё же язык программирования. Можно попробовать написать минификаторы при помощи него. Такие попытки уже были, но мне результат не очень понравился. Например, минифицированный html портил встроенный javascript. Поэтому я решил написать собственный минификатор html, а заодно и javascript.